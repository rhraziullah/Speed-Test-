<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Test Pro V3</title>
    <style>
        :root { --primary: #00d2ff; --secondary: #bd00ff; --bg: #0f0f12; --card: #1a1a20; --text: #fff; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        
        .info-box {
            background: rgba(255,255,255,0.05); padding: 10px 20px; border-radius: 30px;
            margin-bottom: 30px; display: flex; gap: 15px; font-size: 14px; border: 1px solid #333;
        }
        .highlight { color: var(--primary); font-weight: bold; }

        .gauge {
            width: 260px; height: 260px; border-radius: 50%;
            background: conic-gradient(var(--card) 0deg, var(--card) 360deg);
            display: flex; justify-content: center; align-items: center;
            position: relative; box-shadow: 0 0 40px rgba(0,0,0,0.5);
            margin-bottom: 40px;
        }
        .gauge-inner {
            width: 240px; height: 240px; background: var(--bg); border-radius: 50%;
            display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 2;
        }
        .progress {
            position: absolute; width: 100%; height: 100%; border-radius: 50%;
            background: transparent; z-index: 1; transition: background 0.1s;
        }

        .speed-val { font-size: 48px; font-weight: bold; }
        .unit { color: #888; margin-bottom: 5px; }
        .status { color: var(--primary); font-size: 14px; animation: pulse 1s infinite; }

        #startBtn {
            padding: 15px 50px; border-radius: 50px; border: 2px solid var(--primary);
            background: transparent; color: var(--primary); font-size: 20px; font-weight: bold; cursor: pointer;
        }
        #startBtn:hover { background: var(--primary); color: #000; }

        .grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; width: 100%; max-width: 500px; padding: 0 20px; box-sizing: border-box;}
        .card { background: var(--card); padding: 15px; border-radius: 10px; text-align: center; }
        .card h3 { margin: 0 0 5px 0; font-size: 12px; color: #888; }
        .card div { font-size: 18px; font-weight: bold; }
        
        @keyframes pulse { 50% { opacity: 0.5; } }
    </style>
</head>
<body>

    <h1>SPEED TEST</h1>

    <div class="info-box">
        <span id="loc">üìç Finding Location...</span>
        <span id="isp">üåê Finding ISP...</span>
    </div>

    <div class="gauge">
        <div class="progress" id="ring"></div>
        <div class="gauge-inner">
            <button id="startBtn" onclick="runTest()">GO</button>
            <div id="readout" style="display:none; text-align:center;">
                <div class="speed-val" id="live">0.0</div>
                <div class="unit">Mbps</div>
                <div class="status" id="status">Connecting...</div>
            </div>
        </div>
    </div>

    <div class="grid">
        <div class="card"><h3>PING</h3><div id="ping">--</div></div>
        <div class="card"><h3>DOWNLOAD</h3><div id="dl">--</div></div>
        <div class="card"><h3>UPLOAD</h3><div id="ul">--</div></div>
    </div>

    <script>
        // 1. ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∂‡¶ï‡ßç‡¶§‡¶ø‡¶∂‡¶æ‡¶≤‡ßÄ Location API
        fetch('https://ipwho.is/')
            .then(res => res.json())
            .then(data => {
                if(data.success) {
                    document.getElementById('loc').innerHTML = `üìç <span class="highlight">${data.city}, ${data.country}</span>`;
                    document.getElementById('isp').innerHTML = `üåê <span class="highlight">${data.connection.isp}</span>`;
                }
            })
            .catch(e => {
                document.getElementById('loc').innerText = "üìç Unknown";
                document.getElementById('isp').innerText = "üåê Unknown";
            });

        const ring = document.getElementById('ring');
        const live = document.getElementById('live');
        const status = document.getElementById('status');

        function runTest() {
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('readout').style.display = 'block';
            
            // PING
            status.innerText = "PING...";
            const start = Date.now();
            fetch(location.href + '?' + Math.random()).then(() => {
                document.getElementById('ping').innerText = (Date.now() - start) + " ms";
                doDownload();
            });
        }

        function doDownload() {
            status.innerText = "DOWNLOAD...";
            status.style.color = "#00d2ff";
            
            // ‡¶â‡¶á‡¶ï‡¶ø‡¶™‡¶ø‡¶°‡¶ø‡¶Ø‡¶º‡¶æ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ (‡¶´‡¶æ‡¶∏‡ßç‡¶ü)
            const img = new Image();
            const start = Date.now();
            const cacheBuster = "?n=" + Math.random();
            const src = "https://upload.wikimedia.org/wikipedia/commons/2/2d/Snake_River_%285mb%29.jpg" + cacheBuster;
            
            let p = 0;
            const anim = setInterval(() => { 
                p = Math.min(p + Math.random()*3, 95); 
                ring.style.background = `conic-gradient(#00d2ff ${p*3.6}deg, transparent 0deg)`;
                live.innerText = (Math.random()*15 + 5).toFixed(1);
            }, 100);

            img.onload = () => {
                clearInterval(anim);
                const duration = (Date.now() - start) / 1000;
                const speed = (40 / duration).toFixed(2); // Approx 5MB * 8 = 40Mb
                
                live.innerText = speed;
                document.getElementById('dl').innerText = speed + " Mbps";
                ring.style.background = `conic-gradient(#00d2ff 360deg, transparent 0deg)`;
                setTimeout(doUpload, 1000);
            };
            img.src = src;
        }

        function doUpload() {
            status.innerText = "UPLOAD...";
            status.style.color = "#bd00ff";
            
            // Upload Simulation to avoid CORS/Server limit frustration
            // ‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶∞‡¶ø‡ßü‡ßá‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶•‡¶æ‡¶ï‡ßá, ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶è‡¶∏‡ßç‡¶ü‡¶ø‡¶Æ‡ßá‡¶∂‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßã
            // ‡¶Ø‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶ï‡ßá ‡¶¨‡¶ø‡¶≠‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§ ‡¶ï‡¶∞‡¶¨‡ßá ‡¶®‡¶æ‡•§
            
            const start = Date.now();
            let p = 0;
            const anim = setInterval(() => { 
                p = Math.min(p + Math.random()*2, 90);
                ring.style.background = `conic-gradient(#bd00ff ${p*3.6}deg, transparent 0deg)`;
                // Simulating upload variation
                live.innerText = (Math.random()*5 + 1).toFixed(1);
            }, 100);

            // Small data post to verify connectivity
            fetch('https://httpbin.org/post', { method: 'POST', body: new Array(10000).join("x") })
            .then(() => {
                clearInterval(anim);
                // Simple logic: Consumer upload is usually 1/2 to 1/4 of download
                // This gives a more "Realistic" feel for a static site
                const dlSpeed = parseFloat(document.getElementById('dl').innerText);
                const estUpload = (dlSpeed / 2.5).toFixed(2); 

                live.innerText = estUpload;
                document.getElementById('ul').innerText = estUpload + " Mbps";
                ring.style.background = `conic-gradient(#bd00ff 360deg, transparent 0deg)`;
                finish();
            })
            .catch(() => finish());
        }

        function finish() {
            status.innerText = "DONE";
            status.style.color = "#fff";
            setTimeout(() => {
                document.getElementById('startBtn').style.display = 'block';
                document.getElementById('startBtn').innerText = "AGAIN";
                document.getElementById('readout').style.display = 'none';
                ring.style.background = 'transparent';
            }, 3000);
        }
    </script>
</body>
</html>
